# See docs/examples
# http://doc.gitlab.com/ce/ci/quick_start/README.html
# http://doc.gitlab.com/ce/ci/yaml/README.html

# GitLab CI template for Go tests. Note this installs
# a new working copy of Go in a non-standard path such
# that sudo/root is not needed for the install stage.

# note that this particular install-environment stage
# is overly verbose in order to debug anything tricky
# or weird in your environment - feel free to trim it 
# down as needed

stages:
 # - install-environment
  - build
  - baseline


build-jiva:
   stage: build
   image: ubuntu:16.04
   before_script:
     - export COMMIT=${CI_COMMIT_SHA:0:8}
     #- sudo apt-get install -y
     #- sudo apt-get install -y curl open-iscsi
     - mkdir -p $HOME/gopath/bin
   script: 
    - echo "Building-Jiva"
    - echo $COMMIT
    - pwd
    - ls
    - make build

baseline-image:
  stage: baseline
  image: atulabhi/kops:v8
  script:
    - pwd
    #- git clone https://github.com/itsmesinghavneet/baseline.git
    #- cd baseline
    #- wget https://raw.githubusercontent.com/harshvkarn/test-1/baseline/platforms/commit-writer/write-commit.yml
  #  - ansible-playbook write-commit.yml --extra-vars "branch=$CI_PROJECT_NAME commit=ci"
  #  - git add .
  #  - git commit -m "updated baseline jiva"
  #  - git push 'https://itsmesinghavneet:gitlab123@github.com/itsmesinghavneet/baseline.git'
  #  - "curl -X POST -F token=a70ff62f6fb0f8013c687087ae5565 -F ref=test https://gitlab.com/api/v4/projects/7642571/trigger/pipeline"




#build-maya:
#  stage: build
#  script:
#    - cd $CURRENT_BUILD_PATH
#    - go build

#test-my-project:
#  stage: test
#  script:
#    - cd $CURRENT_BUILD_PATH
#    - go test

